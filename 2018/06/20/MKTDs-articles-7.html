<!DOCTYPE html>
<!--  lastBuildDate : Sat, 10 Nov 2018 13:05:44 +0000 -->
<html>
<head>
  
  
  <title>MKTD#6, le Stream processing avec &#35;Flink et &#35;Kafka</title>
  
  <!-- Meta -->
  <meta charset="utf-8">
  <meta http-equiv="content-language" content="fr" />
  <meta name="language" content="fr" />
  <!-- Google site verification -->
  <meta name="google-site-verification" content="Gq_ytzUtfYn95WsiH66e4Lfb8zANT-LUwD8JgH9xXdw" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="keywords" content="Expertise informatique, Dévelopement informatique" />

  <!-- RSS feed -->
  <link rel="alternate" type="application/rss+xml" title=" RSS Feed" href="http://www.monkeypatch.io/blog/feed.xml" />

  <!-- SEO -->
  <meta property="og:title" content="MKTD#6, le Stream processing avec &#35;Flink et &#35;Kafka" />

  
  <meta property="og:description" content="MKTD#6, le Stream processing avec #Flink et #Kafka

Vendredi 16 Mars 2018, nous nous sommes retrouvés une fois de plus (pour notre plus grand plaisir) chez Harrycow Coworking, pour expérimenter 2 technos de Stream processing : Apache Flink et Kafka Streams.

" />
  <meta name="description" content="MKTD#6, le Stream processing avec #Flink et #Kafka

Vendredi 16 Mars 2018, nous nous sommes retrouvés une fois de plus (pour notre plus grand plaisir) chez Harrycow Coworking, pour expérimenter 2 technos de Stream processing : Apache Flink et Kafka Streams.

" />
  
  
  
    <meta name="author" content="Emmanuel Vinas">
    <link rel="author" href="https://plus.google.com/+vinasemmanuel"/>
    
      <link rel="publisher" href="https://plus.google.com/+vinasemmanuel"/>
    
  
    <meta name="author" content="Igor Laborie">
    <link rel="author" href="https://plus.google.com/+IgorLaborie"/>
    
      <link rel="publisher" href="https://plus.google.com/+IgorLaborie"/>
    
  
    <meta name="author" content="Bruno Chauvet">
    <link rel="author" href="https://plus.google.com/"/>
    
      <link rel="publisher" href="https://plus.google.com/"/>
    
  
    <meta name="author" content="Arnaud bos">
    <link rel="author" href="https://plus.google.com/"/>
    
      <link rel="publisher" href="https://plus.google.com/"/>
    
  
    <meta name="author" content="Matthieu Caylet">
    <link rel="author" href="https://plus.google.com/"/>
    
      <link rel="publisher" href="https://plus.google.com/"/>
    
  
    <meta name="author" content="Alteanne Fernandez">
    <link rel="author" href="https://plus.google.com/"/>
    
      <link rel="publisher" href="https://plus.google.com/"/>
    
  
    <meta name="author" content="Guillaume Andrieu">
    <link rel="author" href="https://plus.google.com/"/>
    
      <link rel="publisher" href="https://plus.google.com/"/>
    
  
    <meta name="author" content="Logan Mauzaize">
    <link rel="author" href="https://plus.google.com/"/>
    
      <link rel="publisher" href="https://plus.google.com/"/>
    
  

  
    <meta property="og:type" content="article"/>
    <meta property="og:article:published_time" content="2018-06-20T00:00:00+00:00">
    
      <meta property="og:article:author:username" content="Emmanuel Vinas">
    
      <meta property="og:article:author:username" content="Igor Laborie">
    
      <meta property="og:article:author:username" content="Bruno Chauvet">
    
      <meta property="og:article:author:username" content="Arnaud bos">
    
      <meta property="og:article:author:username" content="Matthieu Caylet">
    
      <meta property="og:article:author:username" content="Alteanne Fernandez">
    
      <meta property="og:article:author:username" content="Guillaume Andrieu">
    
      <meta property="og:article:author:username" content="Logan Mauzaize">
    
    
    <meta property="og:article:tag" content="MonkeyTechDay">
    
    <meta property="og:article:tag" content="Tech days">
    
    <meta property="og:article:tag" content="MKTD">
    
    <meta property="og:article:tag" content="Tech Addicts">
    
    <meta property="og:article:tag" content="Techno">
    
    <meta property="og:article:tag" content="flink">
    
    <meta property="og:article:tag" content="kafka">
    
  
  
  
  <meta property="og:image" content="http://www.monkeypatch.io/public/images/logos/logo-mkp-head-blue-x126.png"/>

  <meta property="og:url" content="http://www.monkeypatch.io/2018/06/20/MKTDs-articles-7.html"/>
  <meta property="og:site_name" content="MonkeyPatch"/>
  
  <!-- Twitter tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:site" content="@MonkeyPatch_io" />
  <meta name="twitter:url" content="http://www.monkeypatch.io/2018/06/20/MKTDs-articles-7.html">
  <meta name="twitter:title" content="MKTD#6, le Stream processing avec &#35;Flink et &#35;Kafka">
  <meta name="twitter:description" content="MKTD#6, le Stream processing avec #Flink et #Kafka

Vendredi 16 Mars 2018, nous nous sommes retrouvés une fois de plus (pour notre plus grand plaisir) chez Harrycow Coworking, pour expérimenter 2 technos de Stream processing : Apache Flink et Kafka Streams.

">
  <meta name="twitter:image" content="http://www.monkeypatch.io/public/images/logos/logo-mkp-head-blue-x126.png">

  <!-- Lang --> 
  <link rel="alternate" hreflang="en" href="http://www.monkeypatch.io/en/index" />
  <link rel="alternate" hreflang="fr" href="http://www.monkeypatch.io/index" />
  
  <meta property="og:locale" content="fr_FR"/>
  <meta property="og:locale:alternate" content="en_US"/>
  

  <link rel="shortcut icon" href="favicon.ico">
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

  <!-- Style -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css">
  <link id="theme-style" rel="stylesheet" href="/css/main.css">

 <script type="application/ld+json">
  {
    "@context": "http://schema.org",
    
      "@type": "BlogPosting", // 
      "mainEntityOfPage": "http://www.monkeypatch.io/2018/06/20/MKTDs-articles-7.html", 
    
    "author": [
      
      { "@type": "Person", "name": "Emmanuel Vinas" },
      
      { "@type": "Person", "name": "Igor Laborie" },
      
      { "@type": "Person", "name": "Bruno Chauvet" },
      
      { "@type": "Person", "name": "Arnaud bos" },
      
      { "@type": "Person", "name": "Matthieu Caylet" },
      
      { "@type": "Person", "name": "Alteanne Fernandez" },
      
      { "@type": "Person", "name": "Guillaume Andrieu" },
      
      { "@type": "Person", "name": "Logan Mauzaize" }
      
    ],
    "name": "MonkeyPatch",
    "headline": "MKTD#6, le Stream processing avec &#35;Flink et &#35;Kafka",
    "image": "http://www.monkeypatch.io/public/images/logos/logo-mkp-head-blue-x126.png",
    
      "datePublished": "2018-06-20T00:00:00+00:00",
      "dateModified": "2018-06-20T00:00:00+00:00",
      "datePublished": "2018-06-20T00:00:00+00:00",
    
    "publisher": {
      "@type": "Organization",
      "name": "MonkeyPatch",
      "logo": "http://www.monkeypatch.io/public/images/logos/logo-mkp-blue-x256.png",
      "sameAs": [
        "https://twitter.com/monkeypatch_io","https://www.linkedin.com/company/monkeypatch-io"
      ]
    },
    "description": "Société de conseil et d'expertise en informatique spécialisée dans les nouvelles technologies.",
    "url": "http://www.monkeypatch.io/2018/06/20/MKTDs-articles-7.html"
  }
</script>
</head>

<body class="post">
  <header>
  <div class="menu">
    <div class="logo">
      <a href="/index">
        <img alt="Monkey Patch" src="/public/images/logos/logo-monkey.svg">
      </a>
    </div>
    
    <nav class="lang">
      <ul>
        <li class="">
          <a href="en/2018/06/20/MKTDs-articles-7.html" >EN</a>
        </li>
        <li class="sep">|</li>
        <li class="active">
          <a href="/2018/06/20/MKTDs-articles-7.html" >FR</a>
        </li>
      </ul>
    </nav>
    
    <nav class="menu">
      <ul>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <li class="">
              <a href="/expert">Notre Expertise</a>
            </li>
          
        
          
            <li class="">
              <a href="/about">Notre Philo</a>
            </li>
          
        
          
            <li class="">
              <a href="/careers">Être Monkeys</a>
            </li>
          
        
          
            <li class="">
              <a href="/job">Nos Jobs</a>
            </li>
          
        
          
            <li class="">
              <a href="/contact">Contact</a>
            </li>
          
        
        <li class="">
          <a href="/blog">Blog</a>
        </li>
      </ul>
    </nav>
      
    <nav class="hamburger">
      <label for="menu-hamburger">
        <i class="fa fa-bars" aria-hidden="true"></i>
      </label>
    </nav>
    
  </div>
  <input type="checkbox" id="menu-hamburger"/>
  <nav class="menu-hamburger">
     <ul>
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
            <li class="">
              <a href="/expert">Notre Expertise</a>
            </li>
          
        
          
            <li class="">
              <a href="/about">Notre Philo</a>
            </li>
          
        
          
            <li class="">
              <a href="/careers">Être Monkeys</a>
            </li>
          
        
          
            <li class="">
              <a href="/job">Nos Jobs</a>
            </li>
          
        
          
            <li class="">
              <a href="/contact">Contact</a>
            </li>
          
        
        <li class="">
          <a href="/blog">Blog</a>
        </li>
      </ul>
      <ul class="lang">
        <li class="">
          <a href="en/2018/06/20/MKTDs-articles-7.html" >EN</a>
        </li>
        <li class="active">
          <a href="/2018/06/20/MKTDs-articles-7.html" >FR</a>
        </li>
      </ul>
  </nav>
</header>

  <main>
    <nav class="index"><!-- fill with JS --></nav>
    <section class="post">
      <h1 id="top">
        <span>MKTD#6, le Stream processing avec &#35;Flink et &#35;Kafka</span>
        <div class="share">
          <a class="twitter-share-button"
            href="https://twitter.com/share"
            data-size="large"
            data-via="monkeypatch_io"
            data-text="MKTD#6, le Stream processing avec &#35;Flink et &#35;Kafka"
            data-hashtags="MonkeyTechDay,Tech days,MKTD,Tech Addicts,Techno,flink,kafka"
            >Tweet</a>
        </div>
      </h1>

      <span class="date">


  June 20, 2018

</span>

      <div class="tags">
        
          <span>MonkeyTechDay</span>
        
          <span>Tech days</span>
        
          <span>MKTD</span>
        
          <span>Tech Addicts</span>
        
          <span>Techno</span>
        
          <span>flink</span>
        
          <span>kafka</span>
        
      </div>

      <article><h1 id="mktd6-le-stream-processing-avec-flink-et-kafka">MKTD#6, le Stream processing avec #Flink et #Kafka</h1>

<p>Vendredi 16 Mars 2018, nous nous sommes retrouvés une fois de plus (pour notre plus grand plaisir) chez <a href="https://www.harrycow.com/">Harrycow Coworking</a>, pour expérimenter 2 technos de Stream processing : Apache Flink et Kafka Streams.</p>

<!--more-->

<p><img src="/public/images/mktd6/1.jpg" alt="PHOTO 1" /></p>

<blockquote>
  <p>Nous n’avons plus besoin de vous présenter les MKTD ! Si ? À priori pas pour tout le monde, alors on fait un bref rappel :
Chaque MonkeyTechDays (MKTD) réunit entre 30 et 45 Tech Addicts, passionnés de dév. En équipe, nous expérimentons, évaluons les technos innovantes sous forme de défis techniques. Une journée au plus près du code, fun et décontractée, où des coachs passionnés aident les participants à réaliser des exos de niveau soutenu.
Pour plus de détails sur l’organisation de la journée, on vous invite à regarder <a href="https://www.meetup.com/fr-FR/MonkeyTechDays/">le planning de la journée</a> ou de parcourir <a href="http://www.monkeypatch.io/2018/02/05/MKTDs-articles-1.html">nos premiers articles.</a></p>
</blockquote>

<p>Pour le MKTD#6, nous avons choisi le sujet du traitement de flux (“Stream processing”) car c’est désormais un concept incontournable du Big Data. Les technos de Stream processing évoluent très vite, on a décidé d’en expérimenter les deux “frères” de la grande famille d’Apache.
Flink et Kafka excellent de plus en plus dans ce domaine. <a href="https://twitter.com/arnaud_bos">Arnaud</a> et <a href="https://twitter.com/glmxndr">Guillaume</a>, 2 Monkeys confirmés, ont respectivement imaginé et confectionné une série de tp/exos/défis à relever tout au long de ce MKTD.</p>

<h2 id="les-technos-expérimentées">Les technos expérimentées</h2>

<h3 id="flink">Flink</h3>
<p><a href="https://flink.apache.org/">Flink</a> est un framework “Big Data” sortant de l’incubateur Apache qui gagne en popularité, basé sur l’unification du batch et du streaming, et dont la signature est une gestion du temps (event time vs processing time) qui lui confère toute sa puissance. Son API riche permet de découper les étapes de processing en unités de calcul modélisant un dataflow.</p>

<p>Comme les autres frameworks “Big Data”, Flink se déploie sous forme d’un cluster comprenant un master et de workers, le premier distribuant le travail décrit par le dataflow aux seconds. Les couches d’abstraction de l’API masquent alors le travail de Flink consistant à gérer le parallélisme et la gestion de l’état.</p>

<p>Enfin, Flink dispose de nombreux “connecteurs” permettant de collecter ou d’émettre des données de ou vers des systèmes tiers, et de librairies de plus haut niveau permettant :</p>
<ul>
  <li>d’exécuter des requêtes directement sur un job en cours d’exécution,</li>
  <li>de construire et requêter des données sous forme de tables (à la SQL) ou de graphes,</li>
  <li>ou encore de Machine Learning.</li>
</ul>

<p><img src="/public/images/mktd6/2.jpg" alt="PHOTO 2" /></p>

<h3 id="kafka-streams">Kafka Streams</h3>
<p><a href="https://kafka.apache.org/documentation/streams/">Kafka Streams</a> permet de développer des applications distribuées sans avoir recours à un cluster autre que Kafka, ce qui simplifie leur déploiement. La librairie permet de coder des services de stream processing, et met à disposition une API de type FRP, s’appuyant sur le messaging et la persistance de Kafka.</p>

<p>Kafka Streams introduit le concept de KTables, qui donne accès à la dernière valeur pour une clé donnée, émulant des updates de BDD relationnelles. L’API permet d’effectuer des opérations de transformation, de branchage et de jointures ainsi que de garder de l’état. Tout ceci s’appuie sur des topics Kafka gérés directement par la librairie.</p>

<p>Enfin, Kafka Streams bénéficie également des autres outils de la suite Confluent, tels que le Schema Registry ou Kafka Connect, qui met à disposition de nombreux connecteurs pour traiter des données depuis ou vers des systèmes tiers.</p>

<p><img src="/public/images/mktd6/3.jpg" alt="PHOTO 3" /></p>

<p><a href="https://docs.google.com/presentation/d/1eeK-15lABBD5DixMUHiKXYWYoJER0_hmDBIx359MNtY/edit?usp=sharing">Voir les slides d’introduction</a></p>

<h3 id="les-exercices">Les exercices</h3>
<p>Pour expérimenter ces deux technos, nous avons donné un thème aux exercices pour toute la journée.</p>

<blockquote>
  <p>Tous les problèmes posés s’inscrivent dans un contexte de simulation de marché : le marché de la banane ! Les participants prennent le rôle de singes-traders jouant en bourse sur l’action de la banane.</p>
</blockquote>

<h4 id="le-matin">Le matin</h4>
<p>Les exercices des deux équipes sont identiques, mais chacun doit les résoudre avec sa techno préférée. Les participants découvrent les opérateurs de base permettant de transformer un flux de données, d’effectuer des branchements avant de réunifier les résultats au sein d’un seul flux de sortie, d’effectuer des traitements d’agrégation sur des fenêtres de temps glissantes ou encore de gérer de l’état. Chaque exercice présente un détail d’implémentation d’un trader, afin de familiariser les participants avec le marché de la banane.</p>

<p><a href="https://github.com/monkeytechdays/mktd6-flink">Voir les exercices Flink</a> 
<a href="https://github.com/monkeytechdays/mktd6">Voir les exercices Kafka</a></p>

<h4 id="laprès-midi">L’après-midi</h4>
<p>Déjà familiarisés avec les règles du jeu par les exos du matin, le défi de l’après-midi est lancé : les participants doivent coder leur propre algo de trading ! 
Le prix d’une action “banane” fluctue aléatoirement, mais les participants peuvent l’influencer via twitter avec le hashtag #MKTD. Les joueurs s’abonnent au flux du prix des actions et leur algo doit choisir entre plusieurs stratégies : acheter/vendre des actions, investir dans une plantation, ou bien… nourrir des singes avec les bananes ! Le serveur calcule alors les résultats des transactions et re-publie l’état des traders avec un score affiché en temps réel.</p>

<blockquote>
  <p>Mais attention, le score n’est pas l’argent ou les actions accumulées, mais le nombre de singes nourris !</p>
</blockquote>

<h2 id="moments-forts-et-bilan-de-la-journée">Moments forts et bilan de la journée</h2>

<p>Encore merci au sponsor pour sa présence et son soutien lors de cette édition ! <a href="https://twitter.com/mattrouget">Matthieu Rouget</a>, responsable technique chez <a href="https://twitter.com/AirbusSpace">Airbus Defence &amp; Space</a>, nous a présenté plusieurs de leurs projets sur le traitement des données massives issues de satellites d’observation de la terre. (franchement sympa la stack)</p>

<p>On remercie également <a href="https://twitter.com/confluentinc">Confluent</a> et <a href="https://twitter.com/dataArtisans">dataArtisans</a> pour les t-shirts et les stickers qu’ils nous ont envoyés. On a profité de ces cadeaux pour lancer un défi commun pour faire gagner à tout le monde un t-Shirt. Défi relevé !</p>

<p><img src="/public/images/mktd6/4.jpg" alt="PHOTO 4" /></p>

<p>On remercie de même l’ensemble des participants. Un spécial grand merci à ceux qui nous ont fait des retours. Ça fait plaisir de voir que l’ambiance était une fois de plus au rendez-vous et que vous voulez tous en refaire :)
Et ceci bien que les exercices étaient parfois un peu compliqués.</p>

<p><img src="/public/images/mktd6/5.png" alt="PHOTO 5" /></p>

<p>On se retrouve au prochain MKTD ?</p>

<p>Les géants du Web tels que Google, poussent de plus en plus la démocratisation de ces standards du Web à grande échelle. Vendredi 21 septembre 2018, on tentera au MKTD#7 d’expérimenter les Web Components nativement ou avec Stencil.</p>

<p><a href="https://www.meetup.com/fr-FR/MonkeyTechDays/events/251431123/">Rdv sur Meetup</a> pour en savoir plus sur l’événement</p>

<p>N’hésitez pas à vous aussi proposer des sujets pour les prochains MKTD, en détaillant vos idées sur le <a href="https://github.com/monkeytechdays/cfp">Cfp</a>.</p>

<p>← Article précédant <a href="http://www.monkeypatch.io/2018/02/05/MKTDs-articles-6.html">MKTD#5</a></p>

</article>

      <div class="authors">
        
          <div class="author">
            <a href="https://twitter.com/alteannefr" rel="author">
              <img src="https://ca.slack-edge.com/T1H5KD6N6-U51C423V4-785b1a19f083-48" alt="Alteanne Fernandez">
              <span>Alteanne Fernandez</span>
            </a>
          </div>
        
          <div class="author">
            <a href="https://twitter.com/MCaylet" rel="author">
              <img src="/public/images/team/matthieu.jpg" alt="Matthieu Caylet">
              <span>Matthieu Caylet</span>
            </a>
          </div>
        
          <div class="author">
            <a href="https://twitter.com/arnaud_bos" rel="author">
              <img src="https://ca.slack-edge.com/T1H5KD6N6-U30C1P23G-a63601ba6c7d-512" alt="Arnaud bos">
              <span>Arnaud bos</span>
            </a>
          </div>
        
          <div class="author">
            <a href="https://twitter.com/glmxndr" rel="author">
              <img src="https://ca.slack-edge.com/T1H5KD6N6-U6C1TJBL7-c93270152bdd-512" alt="Guillaume Andrieu">
              <span>Guillaume Andrieu</span>
            </a>
          </div>
        
      </div>
    </section>

    
    <section class="comment">
      <div id="disqus_thread"></div>
      <script>
      var disqus_config = function () {
          this.page.url = "http://www.monkeypatch.io/2018/06/20/MKTDs-articles-7.html";  // Replace PAGE_URL with your page's canonical URL variable
          this.page.identifier = "/2018/06/20/MKTDs-articles-7.html"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };
      (function() { // DON'T EDIT BELOW THIS LINE
          var d = document, s = d.createElement('script');
          s.src = '//monkeypatchblog.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
      })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </section>
    
    <footer class="top">
    <div>
      <h3>Rester en contact</h3>
      <p>
        <a class="contact" href="contact">
          <i class="fa fa-map-marker" aria-hidden="true"></i>
          <img src="/public/images/icons/Toulouse.png" alt="Toulouse">
        </a>
      </p>
      <p>
        <i class="fa fa-envelope-o" aria-hidden="true"></i>
        <a class="mail" href="mailto:contact@monkeypatch.io">contact@monkeypatch.io</a>
      </p>
    </div>
    <div class="social-network">
      <h3>Réseaux sociaux</h3>
      <ul class="social">
        <li>
          <a href="https://twitter.com/monkeypatch_io">
            <i class="fa fa-twitter" aria-hidden="true"></i>
          </a>
        </li>
        <li>
          <a href="https://www.linkedin.com/company/monkeypatch-io">
            <i class="fa fa-linkedin" aria-hidden="true"></i>
          </a>
        </li>
      </ul>
    </div>
  </div>
</footer>

<footer class="bottom">
  <div>
    Copyright @ 2016 MonkeyPatch -<a href="/terms">Termes et conditions</a>
  </div>
  <div>
    Made with <i class="fa fa-heart" aria-hidden="true"></i> In Toulouse
  </div>
  <a class="goToTop" href="#top">
    <i class="fa fa-caret-up" aria-hidden="true"></i>
  </a>
</footer>

  </main>
  <!-- Google Tag Manager -->
  <noscript>
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-KGGFWH" height="0" width="0" style="display:none;visibility:hidden"></iframe>
  </noscript>
  <script>
    (function(w, d, s, l, i) {
      w[l] = w[l] || [];
      w[l].push({
        'gtm.start': new Date().getTime(),
        event: 'gtm.js'
      });
      var f = d.getElementsByTagName(s)[0],
        j = d.createElement(s),
        dl = l != 'dataLayer' ? '&l=' + l : '';
      j.async = true;
      j.src =
        '//www.googletagmanager.com/gtm.js?id=' + i + dl;
      f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-KGGFWH');
  </script>
  <!-- End Google Tag Manager -->
  <script src="/public/scripts/modernizr-custom.js"></script>
  <script>
document.addEventListener('DOMContentLoaded', function () {
  var i;
  var nav = document.querySelector('nav.index');
  var headers = document.querySelectorAll('article h1, article h2, article h3, article h4, article h5, article h6');

  var createNavHeader = function(id, type, text) {
    var link = document.createElement('a');
    link.textContent = text;
    link.setAttribute('href', '#' + id);

    var text = document.createElement(type);
    text.appendChild(link);
    return text;
  };
  var createHeaderLink = function(id, text) {
    var link = document.createElement('a');
    link.classList.add('anchor');
    link.textContent = text;
    link.setAttribute('href', '#' + id);
    return link;
  };

  var processHeader = function(header) {
    var id = header.id;
    var tag = header.tagName;
    var text = header.textContent;

    var navHeader = createNavHeader(id, tag, text);
    nav.appendChild(navHeader);

    var headerLink = createHeaderLink(id, text);
    header.removeChild(header.firstChild);
    header.appendChild(headerLink);
  }

  for (i = 0; i < headers.length; i++) {
    processHeader(headers[i]);
  }
});
  </script>
  <!-- Share with Twitter -->
  <script>window.twttr = (function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
  if (d.getElementById(id)) return t;
  js = d.createElement(s);
  js.id = id;
  js.src = "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);

  t._e = [];
  t.ready = function(f) {
    t._e.push(f);
  };

  return t;
}(document, "script", "twitter-wjs"));</script>
</body>
</html>
