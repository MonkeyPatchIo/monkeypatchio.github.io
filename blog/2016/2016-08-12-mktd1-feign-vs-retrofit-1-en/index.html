<!DOCTYPE html>
<html lang="fr-FR">

<head>
    
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320"><meta property="og:title" content="Mktd#1 Feign Vs Retrofit : 1 Getting Started">
<meta property="og:description" content="Introduction
Early July we organised in Toulouse our first MonkeyTechDays hosted by HarryCow comparing the technologies: Feign vs Retrofit. The goal of a MKTD is to compare and learn new technologies running challenges throughout the day.
We decided to improve our knowledge of REST clients in Java during this first event. We started with Feign which is designed by Netflix and Retrofit written by Square. These two libraries provide an elegant way to speed up the development of REST clients in Java compare to traditional solutions such as JAX-RS clients, Spring Rest Template, etc…">
<meta property="og:type" content="article">
<meta property="og:url" content="https://monkeypatch.io/blog/2016/2016-08-12-mktd1-feign-vs-retrofit-1-en/">
<meta property="og:image" content="https://www.monkeypatch.io/public/images/logos/logo-mkp-blue-x256.png">
<meta property="article:published_time" content="2016-08-09T00:00:00+00:00">
<meta property="article:modified_time" content="2016-08-09T00:00:00+00:00"><meta property="og:site_name" content="MonkeyPatch">
<meta itemprop="name" content="Mktd#1 Feign Vs Retrofit : 1 Getting Started">
<meta itemprop="description" content="Introduction
Early July we organised in Toulouse our first MonkeyTechDays hosted by HarryCow comparing the technologies: Feign vs Retrofit. The goal of a MKTD is to compare and learn new technologies running challenges throughout the day.
We decided to improve our knowledge of REST clients in Java during this first event. We started with Feign which is designed by Netflix and Retrofit written by Square. These two libraries provide an elegant way to speed up the development of REST clients in Java compare to traditional solutions such as JAX-RS clients, Spring Rest Template, etc…">
<meta itemprop="datePublished" content="2016-08-09T00:00:00&#43;00:00">
<meta itemprop="dateModified" content="2016-08-09T00:00:00&#43;00:00">
<meta itemprop="wordCount" content="1437">
<meta itemprop="image" content="https://www.monkeypatch.io/public/images/logos/logo-mkp-blue-x256.png">



<meta itemprop="keywords" content="MKTD,Java,REST,Feign,Retrofit,"><meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://www.monkeypatch.io/public/images/logos/logo-mkp-blue-x256.png">

<meta name="twitter:title" content="Mktd#1 Feign Vs Retrofit : 1 Getting Started">
<meta name="twitter:description" content="Introduction
Early July we organised in Toulouse our first MonkeyTechDays hosted by HarryCow comparing the technologies: Feign vs Retrofit. The goal of a MKTD is to compare and learn new technologies running challenges throughout the day.
We decided to improve our knowledge of REST clients in Java during this first event. We started with Feign which is designed by Netflix and Retrofit written by Square. These two libraries provide an elegant way to speed up the development of REST clients in Java compare to traditional solutions such as JAX-RS clients, Spring Rest Template, etc…">
<meta name="generator" content="Hugo 0.62.2">

<meta name="ROBOTS" content="INDEX, FOLLOW">

<title>MonkeyPatch  | Mktd#1 Feign Vs Retrofit : 1 Getting Started</title>


<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">






<link rel="stylesheet" href="https://monkeypatch.io/styles/main.a68dfcbd8dbd108ff1ac179c3b5bf75cb5e14ea51ecd4dc44439034e6c03eeef.css">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">

<link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
    
    
    
    

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism-tomorrow.min.css" integrity="sha256-4S9ufRr1EqaUFFeM9/52GH68Hs1Sbvx8eFXBWpl8zPI=" crossorigin="anonymous">

</head>

<body class="page blog blog20162016-08-12-mktd1-feign-vs-retrofit-1-en">

    
    <header>
    
    <div class="menu">
        <div class="logo">
            <a href="https://monkeypatch.io/">
                <img alt="Monkey Patch" src="/images/logos/logo-monkey.svg">
            </a>
        </div>

        <nav class="lang">
            <ul>
                
                <li class="active">
                    <a href="https://monkeypatch.io/">FR</a>
                </li>
                
                <li class="">
                    <a href="https://monkeypatch.io/en/">FR</a>
                </li>
                
            </ul>
        </nav>

        <nav class="menu">
            <ul>
                
                <li class="">
                    <a href="https://monkeypatch.io/expert/">Notre Expertise</a>
                </li>
                
                <li class="">
                    <a href="https://monkeypatch.io/about/">Notre Philo</a>
                </li>
                
                <li class="">
                    <a href="https://monkeypatch.io/careers/">Être Monkeys</a>
                </li>
                
                <li class="">
                    <a href="https://monkeypatch.io/jobs/">Nos Jobs</a>
                </li>
                
                <li class="">
                    <a href="https://monkeypatch.io/contact/">Contact</a>
                </li>
                
                <li class="">
                    <a href="https://monkeypatch.io/blog/">Blog</a>
                </li>
                
            </ul>
        </nav>

        <nav class="hamburger">
            <label for="menu-hamburger">
                <i class="fa fa-bars" aria-hidden="true"></i>
            </label>
        </nav>

    </div>
    <input type="checkbox" id="menu-hamburger">
    <nav class="menu-hamburger">
        <ul>
            
            <li class="">
                <a href="https://monkeypatch.io/expert/">Notre Expertise</a>
            </li>
            
            <li class="">
                <a href="https://monkeypatch.io/about/">Notre Philo</a>
            </li>
            
            <li class="">
                <a href="https://monkeypatch.io/careers/">Être Monkeys</a>
            </li>
            
            <li class="">
                <a href="https://monkeypatch.io/jobs/">Nos Jobs</a>
            </li>
            
            <li class="">
                <a href="https://monkeypatch.io/contact/">Contact</a>
            </li>
            
            <li class="">
                <a href="https://monkeypatch.io/blog/">Blog</a>
            </li>
            
        </ul>
        <ul class="lang">
            
            <li class="active">
                <a href="https://monkeypatch.io/">FR</a>
            </li>
            
            <li class="">
                <a href="https://monkeypatch.io/en/">FR</a>
            </li>
            
        </ul>
    </nav>
</header>
    

    <main>
        <a id="top"></a>
        

<nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#challenge-0-forming-teams">Challenge #0: Forming teams</a></li>
    <li><a href="#challenge-1-getting-started">Challenge #1: Getting started</a></li>
    <li><a href="#feign">Feign</a>
      <ul>
        <li><a href="#dependencies">Dependencies</a></li>
        <li><a href="#interfaces-configuration">Interfaces Configuration</a></li>
        <li><a href="#instances-construction">Instances construction</a></li>
        <li><a href="#conclusion">Conclusion</a></li>
      </ul>
    </li>
    <li><a href="#retrofit">Retrofit</a>
      <ul>
        <li><a href="#conclusion-1">Conclusion</a></li>
      </ul>
    </li>
  </ul>
</nav>

<section class="post">
    <a id="top" name="top"></a>
    <h1>
        <span>Mktd#1 Feign Vs Retrofit : 1 Getting Started</span>
        <div class="share">
            <a class="twitter-share-button" href="https://twitter.com/share" data-size="large" data-via="monkeypatch_io" data-text="Mktd#1 Feign Vs Retrofit : 1 Getting Started" data-hashtags="MKTD,Java,REST,Feign,Retrofit">Tweet</a>

        </div>
    </h1>

    <span class="date">
    August 
    9th,
    2016
</span>

    <div class="tags">
        
        <span>MKTD</span>
        
        <span>Java</span>
        
        <span>REST</span>
        
        <span>Feign</span>
        
        <span>Retrofit</span>
        
    </div>

    <article><h2 id="introduction">Introduction</h2>
<p>Early July we organised in Toulouse our first <a href="http://www.monkeytechdays.com/">MonkeyTechDays</a> hosted by <a href="http://www.harrycow.com/">HarryCow</a> comparing the technologies: <a href="http://www.monkeytechdays.com/events/mktd-1">Feign vs Retrofit</a>. The goal of a MKTD is to compare and learn new technologies running challenges throughout the day.</p>
<p>We decided to improve our knowledge of REST clients in Java during this first event. We started with <a href="https://github.com/OpenFeign/feign">Feign</a> which is designed by <a href="https://netflix.github.io/">Netflix</a> and <a href="http://square.github.io/retrofit/">Retrofit</a> written by <a href="https://github.com/square">Square</a>. These two libraries provide an elegant way to speed up the development of REST clients in Java compare to traditional solutions such as JAX-RS clients, Spring Rest Template, etc…</p>
<p>To bootstrap the teams playing around with these technologies, we had made available several REST services around the Monkeys theme.
Source code writtent this day is available at: <a href="https://github.com/monkeytechdays">https://github.com/monkeytechdays</a></p>
<h2 id="challenge-0-forming-teams">Challenge #0: Forming teams</h2>
<p>This non-technical challenge allows us forming balanced teams on each technology while finishing our breakfast: coffee and croissants. The Feign team was lead by <a href="https://twitter.com/ilaborie">Igor</a> and the Retrofit team by <a href="https://twitter.com/EmmanuelVinas">Emmanuel</a>.</p>
<h2 id="challenge-1-getting-started">Challenge #1: Getting started</h2>
<p>The goal of this first challenge is to get familiar with the technologies.
The principle of <a href="https://github.com/OpenFeign/feign">Feign</a> and <a href="http://square.github.io/retrofit/">Retrofit</a> is to write an interface describing the REST service and the API will take care of implementing an instance of this interface.
At the end of this first challenge, completing the interfaces for the REST services was sufficient to get the unit tests green.</p>
<p>Here are the two interfaces returning JSON format:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MonkeyApi</span> <span style="color:#f92672">{</span>
   Page<span style="color:#f92672">&lt;</span>Monkey<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMonkeys</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> page<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
   Monkey <span style="color:#a6e22e">getMonkeyByName</span><span style="color:#f92672">(</span>String name<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
   Monkey <span style="color:#a6e22e">createMonkey</span><span style="color:#f92672">(</span>Monkey monkey<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
   <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">deleteMonkey</span><span style="color:#f92672">(</span>String id<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MonkeyRaceApi</span> <span style="color:#f92672">{</span>
    List<span style="color:#f92672">&lt;</span>MonkeyRace<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMonkeyRaces</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>and the service returning XML data:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MonkeyStatsApi</span> <span style="color:#f92672">{</span>
    MonkeyStatistics <span style="color:#a6e22e">getMonkeyStats</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>The code is available here: <a href="https://github.com/monkeytechdays/mktd1-defi1">GitHub</a></p>
<p>To pass this challenge, the following is required:</p>
<ul>
<li>GET request and parse the JSON response</li>
<li>GET request with a URL parameter</li>
<li>GET request with a path parameter</li>
<li>POST request with encoded JSON body</li>
<li>DELETE request</li>
<li>GET request and parse the XML response</li>
</ul>
<h2 id="feign">Feign</h2>
<p>The Feign documentation is hosted on Github inside the <a href="https://github.com/OpenFeign/feign">README.md</a>
Extensions documentation is also available in the README.md files of these extensions</p>
<blockquote>
<p>Even if Feign supports Java 6 by default, we have been using Java 8</p>
</blockquote>
<h3 id="dependencies">Dependencies</h3>
<p>To start using Feign inside a project, the following dependencies need to be added to the POM file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;!--</span><span style="color:#75715e"> Feign </span><span style="color:#75715e">--&gt;</span>
<span style="color:#f92672">&lt;dependency</span><span style="color:#f92672">&gt;</span>
   <span style="color:#f92672">&lt;groupId</span><span style="color:#f92672">&gt;</span>com.netflix.feign<span style="color:#f92672">&lt;/groupId&gt;</span>
   <span style="color:#f92672">&lt;artifactId</span><span style="color:#f92672">&gt;</span>feign-core<span style="color:#f92672">&lt;/artifactId&gt;</span>
   <span style="color:#f92672">&lt;version</span><span style="color:#f92672">&gt;</span>8.17.0<span style="color:#f92672">&lt;/version&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>
<span style="color:#75715e">&lt;!--</span><span style="color:#75715e"> Feign: encode/decode JSON with GSON </span><span style="color:#75715e">--&gt;</span>
<span style="color:#f92672">&lt;dependency</span><span style="color:#f92672">&gt;</span>
   <span style="color:#f92672">&lt;groupId</span><span style="color:#f92672">&gt;</span>com.netflix.feign<span style="color:#f92672">&lt;/groupId&gt;</span>
   <span style="color:#f92672">&lt;artifactId</span><span style="color:#f92672">&gt;</span>feign-gson<span style="color:#f92672">&lt;/artifactId&gt;</span>
   <span style="color:#f92672">&lt;version</span><span style="color:#f92672">&gt;</span>8.17.0<span style="color:#f92672">&lt;/version&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>
<span style="color:#75715e">&lt;!--</span><span style="color:#75715e"> Feign: encode/decode XML with JAXB </span><span style="color:#75715e">--&gt;</span>
<span style="color:#f92672">&lt;dependency</span><span style="color:#f92672">&gt;</span>
   <span style="color:#f92672">&lt;groupId</span><span style="color:#f92672">&gt;</span>com.netflix.feign<span style="color:#f92672">&lt;/groupId&gt;</span>
   <span style="color:#f92672">&lt;artifactId</span><span style="color:#f92672">&gt;</span>feign-jaxb<span style="color:#f92672">&lt;/artifactId&gt;</span>
   <span style="color:#f92672">&lt;version</span><span style="color:#f92672">&gt;</span>8.17.0<span style="color:#f92672">&lt;/version&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>
</code></pre></div><blockquote>
<p>We highly recommend setting a maven property to define the version of Feign to be used</p>
</blockquote>
<h3 id="interfaces-configuration">Interfaces Configuration</h3>
<p>The next step is to annotate the interfaces so Feign can implement the HTTP requests of each method. Feign comes with its own annotations describing the HTTP requests:</p>
<ul>
<li><code>@RequestLine</code>: describes the first HTTP line: HTTP verb (GET, POST, PUT, DELETE, …) and path, defining as well the request parameters. Path parameters can be defined using the <code>{name}</code> convention.</li>
<li><code>@Param</code>: binds a variable defined in other annotations (<code>@RequestLine</code>, <code>@Headers</code>, …) and the method parameter. The variable name must be defined by the annotation.</li>
<li><code>@Headers</code>: adds a custom HTTP header, similarly to <code>@RequestLine</code>, the <code>{name}</code> convention can be used to define a variable inside the HTTP header. This annotation is applicable at the interface or method level.
If there is no annotation for the body of a POST or PUT request, the parameters without annotation will be converted inside the request body.</li>
</ul>
<p>So we end up with the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MonkeyRaceApi</span> <span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@RequestLine</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;GET /races&#34;</span><span style="color:#f92672">)</span>
    List<span style="color:#f92672">&lt;</span>MonkeyRace<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMonkeyRaces</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Headers</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Content-Type: application/json&#34;</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MonkeyApi</span> <span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@RequestLine</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;GET ?page={page}&#34;</span><span style="color:#f92672">)</span>
    Page<span style="color:#f92672">&lt;</span>Monkey<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMonkeys</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Param</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;page&#34;</span><span style="color:#f92672">)</span> <span style="color:#66d9ef">int</span> page<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@RequestLine</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;GET /{name}&#34;</span><span style="color:#f92672">)</span>
    Monkey <span style="color:#a6e22e">getMonkeyByName</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Param</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">)</span> String name<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@RequestLine</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;POST &#34;</span><span style="color:#f92672">)</span>
    Monkey <span style="color:#a6e22e">createMonkey</span><span style="color:#f92672">(</span>Monkey monkey<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@RequestLine</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;DELETE /{id}&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">deleteMonkey</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Param</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">)</span> String id<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MonkeyStatsApi</span> <span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@RequestLine</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;GET /stats&#34;</span><span style="color:#f92672">)</span>
    MonkeyStatistics <span style="color:#a6e22e">getMonkeyStats</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="instances-construction">Instances construction</h3>
<p>For the last step, we leverage the API <em>fluent builder</em> provided by Feign to instanciate the interfaces.
This is where the encoders/decoders dependencies added by maven earlier on will kick-in:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">static</span> MonkeyRaceApi <span style="color:#a6e22e">buildRaceApi</span><span style="color:#f92672">(</span>String url<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">return</span> Feign<span style="color:#f92672">.</span><span style="color:#a6e22e">builder</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span>
            <span style="color:#75715e">// Decode JSON from respone body
</span><span style="color:#75715e"></span>            <span style="color:#f92672">.</span><span style="color:#a6e22e">decoder</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> GsonDecoder<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">target</span><span style="color:#f92672">(</span>MonkeyRaceApi<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> url<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">static</span> MonkeyApi <span style="color:#a6e22e">buildMonkeyApi</span><span style="color:#f92672">(</span>String url<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">return</span> Feign<span style="color:#f92672">.</span><span style="color:#a6e22e">builder</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span>
            <span style="color:#75715e">// Decode JSON from respone body
</span><span style="color:#75715e"></span>            <span style="color:#f92672">.</span><span style="color:#a6e22e">decoder</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> GsonDecoder<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
            <span style="color:#75715e">// Encode JSON for request body
</span><span style="color:#75715e"></span>            <span style="color:#f92672">.</span><span style="color:#a6e22e">encoder</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> GsonEncoder<span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">target</span><span style="color:#f92672">(</span>MonkeyApi<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> url <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/monkeys&#34;</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">static</span> MonkeyStatsApi <span style="color:#a6e22e">buildStatsApi</span><span style="color:#f92672">(</span>String url<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">// Create JAXB context factory
</span><span style="color:#75715e"></span>    JAXBContextFactory jaxbFactory <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> JAXBContextFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">Builder</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">withMarshallerJAXBEncoding</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;UTF-8&#34;</span><span style="color:#f92672">)</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">build</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    <span style="color:#66d9ef">return</span> Feign<span style="color:#f92672">.</span><span style="color:#a6e22e">builder</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span>
            <span style="color:#75715e">// Decode XML from response body
</span><span style="color:#75715e"></span>            <span style="color:#f92672">.</span><span style="color:#a6e22e">decoder</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> JAXBDecoder<span style="color:#f92672">(</span>jaxbFactory<span style="color:#f92672">)</span><span style="color:#f92672">)</span>
            <span style="color:#f92672">.</span><span style="color:#a6e22e">target</span><span style="color:#f92672">(</span>MonkeyStatsApi<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> url<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><blockquote>
<p>Feign concatenates the URL with the path defined by the <code>@RequestLine</code> annotation. This provides an easy way to add a prefix to our services if required.</p>
</blockquote>
<h3 id="conclusion">Conclusion</h3>
<p>Very few drawbacks using Feign during this experiment:</p>
<ul>
<li>To get the XML decoding to work, we had to tweak the object so <a href="https://docs.oracle.com/javase/tutorial/jaxb/intro/">JAXB</a> can correctly <em>deserialise</em> the XML response. But this is a more general issue with JAXB and XML parsing.</li>
<li>Error messages are not always easy to decrypt, but with a bit more experience and basic knowledge of the HTTP protocol, this is not really an issue. A typical mistake is to forget the HTTP verb inside the <code>@RequestLine</code> annotation.</li>
</ul>
<p>A lot of benefits:</p>
<ul>
<li>Ease of use and close to HTTP protocol</li>
<li>Very lightweight without any transitive dependencies for <code>feign-core</code></li>
<li>Easy to extend, eg: swapping encoders/decoders <a href="https://github.com/OpenFeign/feign/tree/master/gson">GSON</a>, <a href="https://github.com/OpenFeign/feign/tree/master/jackson">Jackson</a>, <a href="https://github.com/OpenFeign/feign/tree/master/jaxb">JAXB</a></li>
<li>Good support of Java 8, the instances methods <code>static</code> and <code>default</code> are supported</li>
</ul>
<p>General comments</p>
<ul>
<li>There are a few more annotations <code>@Body</code>, <code>@HeaderMap</code>, <code>@QueryMap</code></li>
<li>it is possible to configure how variables (<code>@Param</code>) are converted into String via <code>Expanders</code></li>
<li>The root path of all the interface methods can be added to the URL used by the <em>builder</em></li>
</ul>
<blockquote>
<p>There is no dark magic inside Feign: it relies on the JDK: <code>java.net.HttpURLConnection</code>, <code>java.lang.reflect.Proxy</code>, <code>java.lang.reflect.InvocationHandler</code>, …</p>
</blockquote>
<h2 id="retrofit">Retrofit</h2>
<p>The first step is to add the Retrofit dependencies:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;! -- Retrofit dependency --&gt;</span>
<span style="color:#f92672">&lt;dependency</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;groupId</span><span style="color:#f92672">&gt;</span>com.squareup.retrofit2<span style="color:#f92672">&lt;/groupId&gt;</span>
    <span style="color:#f92672">&lt;artifactId</span><span style="color:#f92672">&gt;</span>retrofit<span style="color:#f92672">&lt;/artifactId&gt;</span>
    <span style="color:#f92672">&lt;version</span><span style="color:#f92672">&gt;</span>${retrofit.version}<span style="color:#f92672">&lt;/version&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>
<span style="color:#75715e">&lt;! -- Jackson converter for JSON --&gt;</span>
<span style="color:#f92672">&lt;dependency</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;groupId</span><span style="color:#f92672">&gt;</span>com.squareup.retrofit2<span style="color:#f92672">&lt;/groupId&gt;</span>
    <span style="color:#f92672">&lt;artifactId</span><span style="color:#f92672">&gt;</span>converter-jackson<span style="color:#f92672">&lt;/artifactId&gt;</span>
    <span style="color:#f92672">&lt;version</span><span style="color:#f92672">&gt;</span>${retrofit.version}<span style="color:#f92672">&lt;/version&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>
<span style="color:#75715e">&lt;!--</span><span style="color:#75715e"> Simple converter for XML </span><span style="color:#75715e">--&gt;</span>
<span style="color:#f92672">&lt;dependency</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;groupId</span><span style="color:#f92672">&gt;</span>com.squareup.retrofit2<span style="color:#f92672">&lt;/groupId&gt;</span>
    <span style="color:#f92672">&lt;artifactId</span><span style="color:#f92672">&gt;</span>converter-simplexml<span style="color:#f92672">&lt;/artifactId&gt;</span>
    <span style="color:#f92672">&lt;version</span><span style="color:#f92672">&gt;</span>${retrofit.version}<span style="color:#f92672">&lt;/version&gt;</span>
<span style="color:#f92672">&lt;/dependency&gt;</span>
</code></pre></div><p>Next step is to add the Retrofit specific annotations to the interface
The rules of the game being to not modify the interface signature, we had to add a new interface to <code>CallFactory</code> used by Retrofit by default.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MonkeyRaceService</span> <span style="color:#f92672">{</span>
   <span style="color:#a6e22e">@GET</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;races&#34;</span><span style="color:#f92672">)</span>
    Call<span style="color:#f92672">&lt;</span>List<span style="color:#f92672">&lt;</span>MonkeyRace<span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMonkeyRaces</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MonkeyService</span> <span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@GET</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;monkeys&#34;</span><span style="color:#f92672">)</span>
    Call<span style="color:#f92672">&lt;</span>Page<span style="color:#f92672">&lt;</span>Monkey<span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMonkeys</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@GET</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;monkeys/{name}&#34;</span><span style="color:#f92672">)</span>
    Call<span style="color:#f92672">&lt;</span>Monkey<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMonkeyByName</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Path</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">)</span> String name<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@POST</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;monkeys&#34;</span><span style="color:#f92672">)</span>
    Call<span style="color:#f92672">&lt;</span>Monkey<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Body</span> Monkey monkey<span style="color:#f92672">)</span><span style="color:#f92672">;</span>

    <span style="color:#a6e22e">@DELETE</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;monkeys/{id}&#34;</span><span style="color:#f92672">)</span>
    Call<span style="color:#f92672">&lt;</span>ResponseBody<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">delete</span><span style="color:#f92672">(</span><span style="color:#a6e22e">@Path</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">)</span> String monkeyId<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">MonkeyStatsService</span> <span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@GET</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/stats&#34;</span><span style="color:#f92672">)</span>
    Call<span style="color:#f92672">&lt;</span>MonkeyStatistics<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMonkeyStats</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>Then we implement the interfaces <code>MonkeyApi</code>, <code>MonkeyRaceApi</code>, <code>MonkeyStatsApi</code> using the Retrofit specific interfaces</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RetrofitMonkeyApi</span> <span style="color:#66d9ef">implements</span> MonkeyApi<span style="color:#f92672">,</span> RetrofitApi <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> MonkeyService monkeyService<span style="color:#f92672">;</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setBaseUrl</span><span style="color:#f92672">(</span>String baseUrl<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        monkeyService <span style="color:#f92672">=</span> createRetrofit<span style="color:#f92672">(</span>baseUrl<span style="color:#f92672">,</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
          <span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span>MonkeyService<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> Page<span style="color:#f92672">&lt;</span>Monkey<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getMonkeys</span><span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> page<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> executeCall<span style="color:#f92672">(</span>monkeyService<span style="color:#f92672">:</span><span style="color:#f92672">:</span>getMonkeys<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> Monkey <span style="color:#a6e22e">getMonkeyByName</span><span style="color:#f92672">(</span>String name<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> executeCall<span style="color:#f92672">(</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> monkeyService<span style="color:#f92672">.</span><span style="color:#a6e22e">getMonkeyByName</span><span style="color:#f92672">(</span>name<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> Monkey <span style="color:#a6e22e">createMonkey</span><span style="color:#f92672">(</span>Monkey monkey<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> executeCall<span style="color:#f92672">(</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> monkeyService<span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span>monkey<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">deleteMonkey</span><span style="color:#f92672">(</span>String id<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        executeCall<span style="color:#f92672">(</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">-</span><span style="color:#f92672">&gt;</span> monkeyService<span style="color:#f92672">.</span><span style="color:#a6e22e">delete</span><span style="color:#f92672">(</span>id<span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">RetrofitApi</span> <span style="color:#f92672">{</span>

    <span style="color:#66d9ef">default</span> Retrofit <span style="color:#a6e22e">createRetrofit</span><span style="color:#f92672">(</span>String baseUrl<span style="color:#f92672">,</span> <span style="color:#66d9ef">boolean</span> useXml<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        Retrofit<span style="color:#f92672">.</span><span style="color:#a6e22e">Builder</span> builder <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Retrofit<span style="color:#f92672">.</span><span style="color:#a6e22e">Builder</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span>
                <span style="color:#f92672">.</span><span style="color:#a6e22e">baseUrl</span><span style="color:#f92672">(</span>baseUrl<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>useXml<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            builder<span style="color:#f92672">.</span><span style="color:#a6e22e">addConverterFactory</span><span style="color:#f92672">(</span>SimpleXmlConverterFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
        builder<span style="color:#f92672">.</span><span style="color:#a6e22e">addConverterFactory</span><span style="color:#f92672">(</span>JacksonConverterFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">create</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#66d9ef">return</span> builder<span style="color:#f92672">.</span><span style="color:#a6e22e">build</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">default</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> T <span style="color:#a6e22e">executeCall</span><span style="color:#f92672">(</span>Supplier<span style="color:#f92672">&lt;</span>Call<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span><span style="color:#f92672">&gt;</span> supplier<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
            Call<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> call <span style="color:#f92672">=</span> supplier<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
            <span style="color:#66d9ef">return</span> call<span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">body</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="conclusion-1">Conclusion</h3>
<h4 id="drawbacks">Drawbacks</h4>
<p>We found quite annoying that there is no way with <code>CallFactory</code> to issue a synchronous call returning an object without having to use the <code>Call</code> object - as this can be done with Feign</p>
<p>It is also possible to create our own <code>CallAdapterFactory</code>. Here is an example from Retrofit test source code:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DirectCallIOException</span> <span style="color:#66d9ef">extends</span> RuntimeException <span style="color:#f92672">{</span>
    DirectCallIOException<span style="color:#f92672">(</span>String message<span style="color:#f92672">,</span> IOException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#66d9ef">super</span><span style="color:#f92672">(</span>message<span style="color:#f92672">,</span> e<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DirectCallAdapterFactory</span> <span style="color:#66d9ef">extends</span> CallAdapter<span style="color:#f92672">.</span><span style="color:#a6e22e">Factory</span> <span style="color:#f92672">{</span>
    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> CallAdapter<span style="color:#f92672">&lt;</span><span style="color:#f92672">?</span><span style="color:#f92672">&gt;</span> get<span style="color:#f92672">(</span><span style="color:#66d9ef">final</span> Type returnType<span style="color:#f92672">,</span> Annotation<span style="color:#f92672">[</span><span style="color:#f92672">]</span> annotations<span style="color:#f92672">,</span> Retrofit retrofit<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> CallAdapter<span style="color:#f92672">&lt;</span>Object<span style="color:#f92672">&gt;</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">public</span> Type <span style="color:#a6e22e">responseType</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> returnType<span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>

            <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">public</span> Object <span style="color:#a6e22e">adapt</span><span style="color:#f92672">(</span>Call call<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
                    <span style="color:#66d9ef">return</span> call<span style="color:#f92672">.</span><span style="color:#a6e22e">execute</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">.</span><span style="color:#a6e22e">body</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span> <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>IOException e<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> DirectCallIOException<span style="color:#f92672">(</span>e<span style="color:#f92672">.</span><span style="color:#a6e22e">getMessage</span><span style="color:#f92672">(</span><span style="color:#f92672">)</span><span style="color:#f92672">,</span> e<span style="color:#f92672">)</span><span style="color:#f92672">;</span>
                <span style="color:#f92672">}</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span><span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>This enforces the handling of exceptions of type <code>DirectCallIOException</code>.</p>
<p>Another pain point encountered with Retrofit is to have to explicitly catch the <code>IOException</code> that can raise from method calls.
Maybe Retrofit could provide exception management in a Feign fashion?
We will find this out during the next part.</p>
<p>The last drawback we found, Retrofit requires several dependencies to run: <a href="http://square.github.io/okhttp/">OkHttp</a> and at least 1 <em>converter</em> which makes the size of the executable much larger that the one generated with Feign (1.5Mo vs 0.5Mo).</p>
<h4 id="benefits">Benefits</h4>
<p>Retrofit is developer friendly. Having the main converters available out of the box is very handy.</p>
<p>Retrofit has its own annotations avoiding typical <em>typo</em>, which is a good thing. Even if Feign has improved a lot on error messages management, we still prefer the way it has been designed by the Retrofit team.</p></article>

    <div class="authors">
        
        <div class="author">
            <a href="https://twitter.com/EmmanuelVinas" rel="author">
                <img src="https://lh3.googleusercontent.com/-PPNaC_SZen8/AAAAAAAAAAI/AAAAAAAARt8/lRnd47vDjyM/s46-c-k-no/photo.jpg" alt="Emmanuel Vinas">
                <span>Emmanuel Vinas</span>
            </a>
        </div>
        
        <div class="author">
            <a href="https://twitter.com/ilaborie" rel="author">
                <img src="http://www.gravatar.com/avatar/5870075cc4934bb7c32f2a6c56cc4f8d?s=48" alt="Igor Laborie">
                <span>Igor Laborie</span>
            </a>
        </div>
        
        <div class="author">
            <a href="https://twitter.com/brunochauvet" rel="author">
                <img src="https://pbs.twimg.com/profile_images/504967695154954240/UlbmZ2uh_400x400.jpeg" alt="Bruno Chauvet">
                <span>Bruno Chauvet</span>
            </a>
        </div>
        
    </div>
</section>


<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "monkeypatchblog" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>




        
        <footer class="top">
    <div>
      <h3>Rester en contact</h3>
      <p>
        <a class="contact icon-map" href="/contact">
          <i class="fa fa-map-marker" aria-hidden="true"></i>
          <img src="/images/icons/Toulouse.png" alt="Toulouse">
        </a>
      </p>
      <p>
        <i class="fa fa-envelope-o" aria-hidden="true"></i>
        <a class="mail" href="mailto:contact@monkeypatch.io">contact@monkeypatch.io</a>
      </p>
    </div>
    <div class="social-network">
      <h3>Réseaux sociaux</h3>
      <ul class="social">
        <li>
          <a href="https://twitter.com/monkeypatch_io">
            <i class="fa fa-twitter" aria-hidden="true"></i>
          </a>
        </li>
        <li>
          <a href="https://www.linkedin.com/company/monkeypatch-io">
            <i class="fa fa-linkedin" aria-hidden="true"></i>
          </a>
        </li>
      </ul>
    </div>
  
</footer>

<footer class="bottom">
  <div>
    Copyright @ 2019 MonkeyPatch -<a href="/terms">Termes et conditions</a>
  </div>
  <div>
    Made with <i class="fa fa-heart" aria-hidden="true"></i> In Toulouse
  </div>
  <a class="goToTop" href="#top">
    <i class="fa fa-caret-up" aria-hidden="true"></i>
  </a>
</footer>

        
    </main>


<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KGGFWH');</script>


<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KGGFWH" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    <script src="/scripts/modernizr-custom.js"></script>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-haskell.min.js" integrity="sha256-MxfNlM5EW2pm9DZPWGvreAHxKNF8NK8DaLSVVtG+MjE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-clojure.min.js" integrity="sha256-eGVrzVqJ/GigoW8fpafNd5j00+zIESDj7FeJcrBUlrA=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-kotlin.min.js" integrity="sha256-BLmzS+mVDv8mg8ciLO7Lxoz1vAYhFtyboFOT0EMY+lg=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-c.min.js" integrity="sha256-POQgKdZt7XGlcjT5opjx6fXs/Pt4eao8x7Q8JRaa/1A=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-brainfuck.min.js" integrity="sha256-VMnAWpm0qsoKYhwjGWpbpIFoEqmKFqgRMvrsPe4SLA8=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-lolcode.js" integrity="sha256-GfPLGNDlIwgQKINyzfQdNvX/cI3Pm9/4nQRGez7eMtc=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-typescript.min.js" integrity="sha256-m2ghaPy1JKNwDlCG/ObigLWw9/7qGHvUhoXp6odkcTI=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-json.min.js" integrity="sha256-oA5rMHeAX+cg/CdcQ0VHmIqqw/IW4o2KAUEjo4QvShs=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-yaml.min.js" integrity="sha256-pxsoS7PqPuy6D5T0Dq2PEXKJ5SRlIkdG8hpoMxQ0YlM=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-java.min.js" integrity="sha256-4jBV//QjNNXvyK55J0R2NwTbl2SAzk/4DHBynIhrxWQ=" crossorigin="anonymous"></script>


<script>
Array.from(document.querySelectorAll(".post article [id]"))
    .forEach(function (elt) {
        var id = elt.getAttribute("id");
        var content = elt.textContent;
        elt.innerHTML = '<a class="anchor" href="#' + id + '">' + content + '</a>';
    });
</script>

<script>
    window.twttr = (function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0],
            t = window.twttr || {};
        if (d.getElementById(id)) return t;
        js = d.createElement(s);
        js.id = id;
        js.src = "https://platform.twitter.com/widgets.js";
        fjs.parentNode.insertBefore(js, fjs);

        t._e = [];
        t.ready = function (f) {
            t._e.push(f);
        };

        return t;
    }(document, "script", "twitter-wjs"));
</script>

</body>

</html>